import 'package:dart_sudoku/src/domain/entities/sheet.dart';
import 'package:dart_sudoku/src/service/presenters/sheet_presenter.dart';
import 'package:test/test.dart';
import 'package:dart_sudoku/src/interaction/sheet_importer.dart';

import '../../../test_utilities/comparisons.dart';
import '../../../test_utilities/factories.dart';


main() {
  group('Validate:', () {
    test('accepts valid sdk import data', () async {
      var sheetFile = 'test_sudoku_easy_1.sdk';
      var sheetImporter = SheetImporter();
      // use test import data
      sheetImporter.importDataPath = 'test/test_import_data/';

      var validationResult = await sheetImporter.validate(dataFile: sheetFile);
      print('validationResult: ${validationResult.message}');

      expect(validationResult.status, true);
    });

    group('Rejects Invalid Data:', () {
      test('invalidates sdk data missing header', () async {
        var sheetFile = 'test_sudoku_easy_1_missing_header.sdk';
        var sheetImporter = SheetImporter();
        // use test import data
        sheetImporter.importDataPath = 'test/test_import_data/';
        var validationResult = await sheetImporter.validate(dataFile: sheetFile);
        print('validationResult: ${validationResult.message}');

        expect(validationResult.status, false);
      });
      test('invalidates sdk data missing elements', () async {
        var sheetFile = 'test_sudoku_easy_1_with_invalid_characters.sdk';
        var sheetImporter = SheetImporter();
        // use test import data
        sheetImporter.importDataPath = 'test/test_import_data/';
        var validationResult = await sheetImporter.validate(dataFile: sheetFile);
        print('validationResult: ${validationResult.message}');

        expect(validationResult.status, false);
      });
      test('rejects files without sdk extension', () async {
        var sheetFile = 'test_sudoku_easy_1_missing_extension';
        var sheetImporter = SheetImporter();
        // use test import data
        sheetImporter.importDataPath = 'test/test_import_data/';
        var validationResult = await sheetImporter.validate(dataFile: sheetFile);
        print('validationResult: ${validationResult.message}');

        expect(validationResult.status, false);
      });
    });
  });
  group('Import:', () {
    test('imports data from sdk file', () async {
      const fileName = 'test_sudoku_easy_1.sdk';
      var sheetImporter = SheetImporter();
      // use test import data
      sheetImporter.importDataPath = 'test/test_import_data/';
      await sheetImporter.importFileContent(fileName: fileName);

      expect(sheetImporter.puzzleData, validEasySDKData);
    });
    test('cleans sdk file data missing elements', () {
      var sheetImporter = SheetImporter();
      sheetImporter.puzzleData = validEasySDKData;
      sheetImporter.cleanSDKFileData(sdkFileData: validEasySDKData);
      expect(sheetImporter.puzzleData, cleanValidEasySDKData);
    });
    test('builds sheet data from a dummy sdk file', () {
      var blankSheet = Sheet(SheetInitializer());
      var sheetImporter = SheetImporter();

      var sheet = sheetImporter.buildSheet(puzzleData: cleanDummySDKData);

      var canvas = StringBuffer();
      var sheetPresenter = SheetPresenter(canvas);
      sheetPresenter.writeSheet(sheet);
      // print(sheetPresenter.canvas);

      var canvas2 = StringBuffer();
      var sheetPresenter2 = SheetPresenter(canvas2);
      sheetPresenter2.writeSheet(sheet);
      // print(sheetPresenter2.canvas);

      expect(sheetEqual(sheet1: sheet, sheet2: blankSheet), true);
    });
    test('builds sheet data from a sample sdk file', () {
      var dummySheet = createDummySheet({3}, 4, 6);
      var sheetImporter = SheetImporter();

      var sheet = sheetImporter.buildSheet(puzzleData: cleanSimpleSDKData);

      var canvas = StringBuffer();
      var sheetPresenter = SheetPresenter(canvas);
      sheetPresenter.writeSheet(sheet);
      // print(sheetPresenter.canvas);

      var canvas2 = StringBuffer();
      var sheetPresenter2 = SheetPresenter(canvas2);
      sheetPresenter2.writeSheet(sheet);
      // print(sheetPresenter2.canvas);

      expect(sheetEqual(sheet1: sheet, sheet2: dummySheet), true);
    });
    test('imports a sheet', () async {
      var sheetImporter = SheetImporter();
      sheetImporter.importDataPath = 'test/test_import_data/';
      var dataFile = 'test_sudoku_easy_1.sdk';

      Sheet importedSheet = await sheetImporter.importToSheet(fileName: dataFile);

      var sheetPresenter = SheetPresenter();
      sheetPresenter.writeSheet(importedSheet);
      // print(sheetPresenter.canvas);
      // print('\n');
      // print(sheetPresenter.canvas.toString().codeUnits);

      expect(bufferEqualsCodeUnits(sheetPresenter.canvas, importedSudokuEasy1SheetChars), true);
    });
  });
}

var sdkDataMissingCharacters = '''[Puzzle]
.1......
6..1..4.9
7.4..81.
.97...2.4
.42.1...7
..84...1.
.5.3497..
..3.5689.
92.8.134.
''';

const validEasySDKData = '''
[Puzzle]
.1......8
6..1..4.9
7.4..81.2
.97...2.4
.42.1...7
..84...1.
.5.3497..
..3.5689.
92.8.134.
''';

const dummySDKData = '''
[Puzzle]
.........
.........
.........
.........
.........
.........
.........
.........
.........
''';

const cleanDummySDKData = '''
.........
.........
.........
.........
.........
.........
.........
.........
.........
''';

const cleanValidEasySDKData = '''
.1......8
6..1..4.9
7.4..81.2
.97...2.4
.42.1...7
..84...1.
.5.3497..
..3.5689.
92.8.134.
''';

const cleanSimpleSDKData = '''
.........
.........
.........
.........
.........
...3.....
.........
.........
.........
''';

// ╔═══╤═══╤═══╦═══╤═══╤═══╦═══╤═══╤═══╗
// ║123│   │123║123│123│123║123│123│   ║
// ║456│ 1 │456║456│456│456║456│456│ 8 ║
// ║789│   │789║789│789│789║789│789│   ║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║   │123│123║   │123│123║   │123│   ║
// ║ 6 │456│456║ 1 │456│456║ 4 │456│ 9 ║
// ║   │789│789║   │789│789║   │789│   ║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║   │123│   ║123│123│   ║   │123│   ║
// ║ 7 │456│ 4 ║456│456│ 8 ║ 1 │456│ 2 ║
// ║   │789│   ║789│789│   ║   │789│   ║
// ╠═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╣
// ║123│   │   ║123│123│123║   │123│   ║
// ║456│ 9 │ 7 ║456│456│456║ 2 │456│ 4 ║
// ║789│   │   ║789│789│789║   │789│   ║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║123│   │   ║123│   │123║123│123│   ║
// ║456│ 4 │ 2 ║456│ 1 │456║456│456│ 7 ║
// ║789│   │   ║789│   │789║789│789│   ║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║123│123│   ║   │123│123║123│   │123║
// ║456│456│ 8 ║ 4 │456│456║456│ 1 │456║
// ║789│789│   ║   │789│789║789│   │789║
// ╠═══╪═══╪═══╬═══╪═══╪═══╬═══╪═══╪═══╣
// ║123│   │123║   │   │   ║   │123│123║
// ║456│ 5 │456║ 3 │ 4 │ 9 ║ 7 │456│456║
// ║789│   │789║   │   │   ║   │789│789║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║123│123│   ║123│   │   ║   │   │123║
// ║456│456│ 3 ║456│ 5 │ 6 ║ 8 │ 9 │456║
// ║789│789│   ║789│   │   ║   │   │789║
// ╟───┼───┼───╫───┼───┼───╫───┼───┼───╢
// ║   │   │123║   │123│   ║   │   │123║
// ║ 9 │ 2 │456║ 8 │456│ 1 ║ 3 │ 4 │456║
// ║   │   │789║   │789│   ║   │   │789║
// ╚═══╧═══╧═══╩═══╧═══╧═══╩═══╧═══╧═══╝
//
const importedSudokuEasy1SheetChars = [27, 99, 9556, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9574, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9574, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9572, 9552, 9552, 9552, 9559, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9568, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9580, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9580, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9571, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9568, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9580, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9580, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9578, 9552, 9552, 9552, 9571, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9567, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9579, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9532, 9472, 9472, 9472, 9570, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9474, 8226, 8226, 8226, 9553, 10, 9562, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9577, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9577, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9575, 9552, 9552, 9552, 9565, 10, 27, 91, 50, 59, 50, 72, 49, 50, 51, 27, 91, 51, 59, 50, 72, 52, 53, 54, 27, 91, 52, 59, 50, 72, 55, 56, 57, 27, 91, 53, 59, 50, 72, 27, 91, 50, 59, 54, 72, 32, 32, 32, 27, 91, 51, 59, 54, 72, 32, 49, 32, 27, 91, 52, 59, 54, 72, 32, 32, 32, 27, 91, 53, 59, 54, 72, 27, 91, 50, 59, 49, 48, 72, 49, 50, 51, 27, 91, 51, 59, 49, 48, 72, 52, 53, 54, 27, 91, 52, 59, 49, 48, 72, 55, 56, 57, 27, 91, 53, 59, 49, 48, 72, 27, 91, 50, 59, 49, 52, 72, 49, 50, 51, 27, 91, 51, 59, 49, 52, 72, 52, 53, 54, 27, 91, 52, 59, 49, 52, 72, 55, 56, 57, 27, 91, 53, 59, 49, 52, 72, 27, 91, 50, 59, 49, 56, 72, 49, 50, 51, 27, 91, 51, 59, 49, 56, 72, 52, 53, 54, 27, 91, 52, 59, 49, 56, 72, 55, 56, 57, 27, 91, 53, 59, 49, 56, 72, 27, 91, 50, 59, 50, 50, 72, 49, 50, 51, 27, 91, 51, 59, 50, 50, 72, 52, 53, 54, 27, 91, 52, 59, 50, 50, 72, 55, 56, 57, 27, 91, 53, 59, 50, 50, 72, 27, 91, 50, 59, 50, 54, 72, 49, 50, 51, 27, 91, 51, 59, 50, 54, 72, 52, 53, 54, 27, 91, 52, 59, 50, 54, 72, 55, 56, 57, 27, 91, 53, 59, 50, 54, 72, 27, 91, 50, 59, 51, 48, 72, 49, 50, 51, 27, 91, 51, 59, 51, 48, 72, 52, 53, 54, 27, 91, 52, 59, 51, 48, 72, 55, 56, 57, 27, 91, 53, 59, 51, 48, 72, 27, 91, 50, 59, 51, 52, 72, 32, 32, 32, 27, 91, 51, 59, 51, 52, 72, 32, 56, 32, 27, 91, 52, 59, 51, 52, 72, 32, 32, 32, 27, 91, 53, 59, 51, 52, 72, 27, 91, 54, 59, 50, 72, 32, 32, 32, 27, 91, 55, 59, 50, 72, 32, 54, 32, 27, 91, 56, 59, 50, 72, 32, 32, 32, 27, 91, 57, 59, 50, 72, 27, 91, 54, 59, 54, 72, 49, 50, 51, 27, 91, 55, 59, 54, 72, 52, 53, 54, 27, 91, 56, 59, 54, 72, 55, 56, 57, 27, 91, 57, 59, 54, 72, 27, 91, 54, 59, 49, 48, 72, 49, 50, 51, 27, 91, 55, 59, 49, 48, 72, 52, 53, 54, 27, 91, 56, 59, 49, 48, 72, 55, 56, 57, 27, 91, 57, 59, 49, 48, 72, 27, 91, 54, 59, 49, 52, 72, 32, 32, 32, 27, 91, 55, 59, 49, 52, 72, 32, 49, 32, 27, 91, 56, 59, 49, 52, 72, 32, 32, 32, 27, 91, 57, 59, 49, 52, 72, 27, 91, 54, 59, 49, 56, 72, 49, 50, 51, 27, 91, 55, 59, 49, 56, 72, 52, 53, 54, 27, 91, 56, 59, 49, 56, 72, 55, 56, 57, 27, 91, 57, 59, 49, 56, 72, 27, 91, 54, 59, 50, 50, 72, 49, 50, 51, 27, 91, 55, 59, 50, 50, 72, 52, 53, 54, 27, 91, 56, 59, 50, 50, 72, 55, 56, 57, 27, 91, 57, 59, 50, 50, 72, 27, 91, 54, 59, 50, 54, 72, 32, 32, 32, 27, 91, 55, 59, 50, 54, 72, 32, 52, 32, 27, 91, 56, 59, 50, 54, 72, 32, 32, 32, 27, 91, 57, 59, 50, 54, 72, 27, 91, 54, 59, 51, 48, 72, 49, 50, 51, 27, 91, 55, 59, 51, 48, 72, 52, 53, 54, 27, 91, 56, 59, 51, 48, 72, 55, 56, 57, 27, 91, 57, 59, 51, 48, 72, 27, 91, 54, 59, 51, 52, 72, 32, 32, 32, 27, 91, 55, 59, 51, 52, 72, 32, 57, 32, 27, 91, 56, 59, 51, 52, 72, 32, 32, 32, 27, 91, 57, 59, 51, 52, 72, 27, 91, 49, 48, 59, 50, 72, 32, 32, 32, 27, 91, 49, 49, 59, 50, 72, 32, 55, 32, 27, 91, 49, 50, 59, 50, 72, 32, 32, 32, 27, 91, 49, 51, 59, 50, 72, 27, 91, 49, 48, 59, 54, 72, 49, 50, 51, 27, 91, 49, 49, 59, 54, 72, 52, 53, 54, 27, 91, 49, 50, 59, 54, 72, 55, 56, 57, 27, 91, 49, 51, 59, 54, 72, 27, 91, 49, 48, 59, 49, 48, 72, 32, 32, 32, 27, 91, 49, 49, 59, 49, 48, 72, 32, 52, 32, 27, 91, 49, 50, 59, 49, 48, 72, 32, 32, 32, 27, 91, 49, 51, 59, 49, 48, 72, 27, 91, 49, 48, 59, 49, 52, 72, 49, 50, 51, 27, 91, 49, 49, 59, 49, 52, 72, 52, 53, 54, 27, 91, 49, 50, 59, 49, 52, 72, 55, 56, 57, 27, 91, 49, 51, 59, 49, 52, 72, 27, 91, 49, 48, 59, 49, 56, 72, 49, 50, 51, 27, 91, 49, 49, 59, 49, 56, 72, 52, 53, 54, 27, 91, 49, 50, 59, 49, 56, 72, 55, 56, 57, 27, 91, 49, 51, 59, 49, 56, 72, 27, 91, 49, 48, 59, 50, 50, 72, 32, 32, 32, 27, 91, 49, 49, 59, 50, 50, 72, 32, 56, 32, 27, 91, 49, 50, 59, 50, 50, 72, 32, 32, 32, 27, 91, 49, 51, 59, 50, 50, 72, 27, 91, 49, 48, 59, 50, 54, 72, 32, 32, 32, 27, 91, 49, 49, 59, 50, 54, 72, 32, 49, 32, 27, 91, 49, 50, 59, 50, 54, 72, 32, 32, 32, 27, 91, 49, 51, 59, 50, 54, 72, 27, 91, 49, 48, 59, 51, 48, 72, 49, 50, 51, 27, 91, 49, 49, 59, 51, 48, 72, 52, 53, 54, 27, 91, 49, 50, 59, 51, 48, 72, 55, 56, 57, 27, 91, 49, 51, 59, 51, 48, 72, 27, 91, 49, 48, 59, 51, 52, 72, 32, 32, 32, 27, 91, 49, 49, 59, 51, 52, 72, 32, 50, 32, 27, 91, 49, 50, 59, 51, 52, 72, 32, 32, 32, 27, 91, 49, 51, 59, 51, 52, 72, 27, 91, 49, 52, 59, 50, 72, 49, 50, 51, 27, 91, 49, 53, 59, 50, 72, 52, 53, 54, 27, 91, 49, 54, 59, 50, 72, 55, 56, 57, 27, 91, 49, 55, 59, 50, 72, 27, 91, 49, 52, 59, 54, 72, 32, 32, 32, 27, 91, 49, 53, 59, 54, 72, 32, 57, 32, 27, 91, 49, 54, 59, 54, 72, 32, 32, 32, 27, 91, 49, 55, 59, 54, 72, 27, 91, 49, 52, 59, 49, 48, 72, 32, 32, 32, 27, 91, 49, 53, 59, 49, 48, 72, 32, 55, 32, 27, 91, 49, 54, 59, 49, 48, 72, 32, 32, 32, 27, 91, 49, 55, 59, 49, 48, 72, 27, 91, 49, 52, 59, 49, 52, 72, 49, 50, 51, 27, 91, 49, 53, 59, 49, 52, 72, 52, 53, 54, 27, 91, 49, 54, 59, 49, 52, 72, 55, 56, 57, 27, 91, 49, 55, 59, 49, 52, 72, 27, 91, 49, 52, 59, 49, 56, 72, 49, 50, 51, 27, 91, 49, 53, 59, 49, 56, 72, 52, 53, 54, 27, 91, 49, 54, 59, 49, 56, 72, 55, 56, 57, 27, 91, 49, 55, 59, 49, 56, 72, 27, 91, 49, 52, 59, 50, 50, 72, 49, 50, 51, 27, 91, 49, 53, 59, 50, 50, 72, 52, 53, 54, 27, 91, 49, 54, 59, 50, 50, 72, 55, 56, 57, 27, 91, 49, 55, 59, 50, 50, 72, 27, 91, 49, 52, 59, 50, 54, 72, 32, 32, 32, 27, 91, 49, 53, 59, 50, 54, 72, 32, 50, 32, 27, 91, 49, 54, 59, 50, 54, 72, 32, 32, 32, 27, 91, 49, 55, 59, 50, 54, 72, 27, 91, 49, 52, 59, 51, 48, 72, 49, 50, 51, 27, 91, 49, 53, 59, 51, 48, 72, 52, 53, 54, 27, 91, 49, 54, 59, 51, 48, 72, 55, 56, 57, 27, 91, 49, 55, 59, 51, 48, 72, 27, 91, 49, 52, 59, 51, 52, 72, 32, 32, 32, 27, 91, 49, 53, 59, 51, 52, 72, 32, 52, 32, 27, 91, 49, 54, 59, 51, 52, 72, 32, 32, 32, 27, 91, 49, 55, 59, 51, 52, 72, 27, 91, 49, 56, 59, 50, 72, 49, 50, 51, 27, 91, 49, 57, 59, 50, 72, 52, 53, 54, 27, 91, 50, 48, 59, 50, 72, 55, 56, 57, 27, 91, 50, 49, 59, 50, 72, 27, 91, 49, 56, 59, 54, 72, 32, 32, 32, 27, 91, 49, 57, 59, 54, 72, 32, 52, 32, 27, 91, 50, 48, 59, 54, 72, 32, 32, 32, 27, 91, 50, 49, 59, 54, 72, 27, 91, 49, 56, 59, 49, 48, 72, 32, 32, 32, 27, 91, 49, 57, 59, 49, 48, 72, 32, 50, 32, 27, 91, 50, 48, 59, 49, 48, 72, 32, 32, 32, 27, 91, 50, 49, 59, 49, 48, 72, 27, 91, 49, 56, 59, 49, 52, 72, 49, 50, 51, 27, 91, 49, 57, 59, 49, 52, 72, 52, 53, 54, 27, 91, 50, 48, 59, 49, 52, 72, 55, 56, 57, 27, 91, 50, 49, 59, 49, 52, 72, 27, 91, 49, 56, 59, 49, 56, 72, 32, 32, 32, 27, 91, 49, 57, 59, 49, 56, 72, 32, 49, 32, 27, 91, 50, 48, 59, 49, 56, 72, 32, 32, 32, 27, 91, 50, 49, 59, 49, 56, 72, 27, 91, 49, 56, 59, 50, 50, 72, 49, 50, 51, 27, 91, 49, 57, 59, 50, 50, 72, 52, 53, 54, 27, 91, 50, 48, 59, 50, 50, 72, 55, 56, 57, 27, 91, 50, 49, 59, 50, 50, 72, 27, 91, 49, 56, 59, 50, 54, 72, 49, 50, 51, 27, 91, 49, 57, 59, 50, 54, 72, 52, 53, 54, 27, 91, 50, 48, 59, 50, 54, 72, 55, 56, 57, 27, 91, 50, 49, 59, 50, 54, 72, 27, 91, 49, 56, 59, 51, 48, 72, 49, 50, 51, 27, 91, 49, 57, 59, 51, 48, 72, 52, 53, 54, 27, 91, 50, 48, 59, 51, 48, 72, 55, 56, 57, 27, 91, 50, 49, 59, 51, 48, 72, 27, 91, 49, 56, 59, 51, 52, 72, 32, 32, 32, 27, 91, 49, 57, 59, 51, 52, 72, 32, 55, 32, 27, 91, 50, 48, 59, 51, 52, 72, 32, 32, 32, 27, 91, 50, 49, 59, 51, 52, 72, 27, 91, 50, 50, 59, 50, 72, 49, 50, 51, 27, 91, 50, 51, 59, 50, 72, 52, 53, 54, 27, 91, 50, 52, 59, 50, 72, 55, 56, 57, 27, 91, 50, 53, 59, 50, 72, 27, 91, 50, 50, 59, 54, 72, 49, 50, 51, 27, 91, 50, 51, 59, 54, 72, 52, 53, 54, 27, 91, 50, 52, 59, 54, 72, 55, 56, 57, 27, 91, 50, 53, 59, 54, 72, 27, 91, 50, 50, 59, 49, 48, 72, 32, 32, 32, 27, 91, 50, 51, 59, 49, 48, 72, 32, 56, 32, 27, 91, 50, 52, 59, 49, 48, 72, 32, 32, 32, 27, 91, 50, 53, 59, 49, 48, 72, 27, 91, 50, 50, 59, 49, 52, 72, 32, 32, 32, 27, 91, 50, 51, 59, 49, 52, 72, 32, 52, 32, 27, 91, 50, 52, 59, 49, 52, 72, 32, 32, 32, 27, 91, 50, 53, 59, 49, 52, 72, 27, 91, 50, 50, 59, 49, 56, 72, 49, 50, 51, 27, 91, 50, 51, 59, 49, 56, 72, 52, 53, 54, 27, 91, 50, 52, 59, 49, 56, 72, 55, 56, 57, 27, 91, 50, 53, 59, 49, 56, 72, 27, 91, 50, 50, 59, 50, 50, 72, 49, 50, 51, 27, 91, 50, 51, 59, 50, 50, 72, 52, 53, 54, 27, 91, 50, 52, 59, 50, 50, 72, 55, 56, 57, 27, 91, 50, 53, 59, 50, 50, 72, 27, 91, 50, 50, 59, 50, 54, 72, 49, 50, 51, 27, 91, 50, 51, 59, 50, 54, 72, 52, 53, 54, 27, 91, 50, 52, 59, 50, 54, 72, 55, 56, 57, 27, 91, 50, 53, 59, 50, 54, 72, 27, 91, 50, 50, 59, 51, 48, 72, 32, 32, 32, 27, 91, 50, 51, 59, 51, 48, 72, 32, 49, 32, 27, 91, 50, 52, 59, 51, 48, 72, 32, 32, 32, 27, 91, 50, 53, 59, 51, 48, 72, 27, 91, 50, 50, 59, 51, 52, 72, 49, 50, 51, 27, 91, 50, 51, 59, 51, 52, 72, 52, 53, 54, 27, 91, 50, 52, 59, 51, 52, 72, 55, 56, 57, 27, 91, 50, 53, 59, 51, 52, 72, 27, 91, 50, 54, 59, 50, 72, 49, 50, 51, 27, 91, 50, 55, 59, 50, 72, 52, 53, 54, 27, 91, 50, 56, 59, 50, 72, 55, 56, 57, 27, 91, 50, 57, 59, 50, 72, 27, 91, 50, 54, 59, 54, 72, 32, 32, 32, 27, 91, 50, 55, 59, 54, 72, 32, 53, 32, 27, 91, 50, 56, 59, 54, 72, 32, 32, 32, 27, 91, 50, 57, 59, 54, 72, 27, 91, 50, 54, 59, 49, 48, 72, 49, 50, 51, 27, 91, 50, 55, 59, 49, 48, 72, 52, 53, 54, 27, 91, 50, 56, 59, 49, 48, 72, 55, 56, 57, 27, 91, 50, 57, 59, 49, 48, 72, 27, 91, 50, 54, 59, 49, 52, 72, 32, 32, 32, 27, 91, 50, 55, 59, 49, 52, 72, 32, 51, 32, 27, 91, 50, 56, 59, 49, 52, 72, 32, 32, 32, 27, 91, 50, 57, 59, 49, 52, 72, 27, 91, 50, 54, 59, 49, 56, 72, 32, 32, 32, 27, 91, 50, 55, 59, 49, 56, 72, 32, 52, 32, 27, 91, 50, 56, 59, 49, 56, 72, 32, 32, 32, 27, 91, 50, 57, 59, 49, 56, 72, 27, 91, 50, 54, 59, 50, 50, 72, 32, 32, 32, 27, 91, 50, 55, 59, 50, 50, 72, 32, 57, 32, 27, 91, 50, 56, 59, 50, 50, 72, 32, 32, 32, 27, 91, 50, 57, 59, 50, 50, 72, 27, 91, 50, 54, 59, 50, 54, 72, 32, 32, 32, 27, 91, 50, 55, 59, 50, 54, 72, 32, 55, 32, 27, 91, 50, 56, 59, 50, 54, 72, 32, 32, 32, 27, 91, 50, 57, 59, 50, 54, 72, 27, 91, 50, 54, 59, 51, 48, 72, 49, 50, 51, 27, 91, 50, 55, 59, 51, 48, 72, 52, 53, 54, 27, 91, 50, 56, 59, 51, 48, 72, 55, 56, 57, 27, 91, 50, 57, 59, 51, 48, 72, 27, 91, 50, 54, 59, 51, 52, 72, 49, 50, 51, 27, 91, 50, 55, 59, 51, 52, 72, 52, 53, 54, 27, 91, 50, 56, 59, 51, 52, 72, 55, 56, 57, 27, 91, 50, 57, 59, 51, 52, 72, 27, 91, 51, 48, 59, 50, 72, 49, 50, 51, 27, 91, 51, 49, 59, 50, 72, 52, 53, 54, 27, 91, 51, 50, 59, 50, 72, 55, 56, 57, 27, 91, 51, 51, 59, 50, 72, 27, 91, 51, 48, 59, 54, 72, 49, 50, 51, 27, 91, 51, 49, 59, 54, 72, 52, 53, 54, 27, 91, 51, 50, 59, 54, 72, 55, 56, 57, 27, 91, 51, 51, 59, 54, 72, 27, 91, 51, 48, 59, 49, 48, 72, 32, 32, 32, 27, 91, 51, 49, 59, 49, 48, 72, 32, 51, 32, 27, 91, 51, 50, 59, 49, 48, 72, 32, 32, 32, 27, 91, 51, 51, 59, 49, 48, 72, 27, 91, 51, 48, 59, 49, 52, 72, 49, 50, 51, 27, 91, 51, 49, 59, 49, 52, 72, 52, 53, 54, 27, 91, 51, 50, 59, 49, 52, 72, 55, 56, 57, 27, 91, 51, 51, 59, 49, 52, 72, 27, 91, 51, 48, 59, 49, 56, 72, 32, 32, 32, 27, 91, 51, 49, 59, 49, 56, 72, 32, 53, 32, 27, 91, 51, 50, 59, 49, 56, 72, 32, 32, 32, 27, 91, 51, 51, 59, 49, 56, 72, 27, 91, 51, 48, 59, 50, 50, 72, 32, 32, 32, 27, 91, 51, 49, 59, 50, 50, 72, 32, 54, 32, 27, 91, 51, 50, 59, 50, 50, 72, 32, 32, 32, 27, 91, 51, 51, 59, 50, 50, 72, 27, 91, 51, 48, 59, 50, 54, 72, 32, 32, 32, 27, 91, 51, 49, 59, 50, 54, 72, 32, 56, 32, 27, 91, 51, 50, 59, 50, 54, 72, 32, 32, 32, 27, 91, 51, 51, 59, 50, 54, 72, 27, 91, 51, 48, 59, 51, 48, 72, 32, 32, 32, 27, 91, 51, 49, 59, 51, 48, 72, 32, 57, 32, 27, 91, 51, 50, 59, 51, 48, 72, 32, 32, 32, 27, 91, 51, 51, 59, 51, 48, 72, 27, 91, 51, 48, 59, 51, 52, 72, 49, 50, 51, 27, 91, 51, 49, 59, 51, 52, 72, 52, 53, 54, 27, 91, 51, 50, 59, 51, 52, 72, 55, 56, 57, 27, 91, 51, 51, 59, 51, 52, 72, 27, 91, 51, 52, 59, 50, 72, 32, 32, 32, 27, 91, 51, 53, 59, 50, 72, 32, 57, 32, 27, 91, 51, 54, 59, 50, 72, 32, 32, 32, 27, 91, 51, 55, 59, 50, 72, 27, 91, 51, 52, 59, 54, 72, 32, 32, 32, 27, 91, 51, 53, 59, 54, 72, 32, 50, 32, 27, 91, 51, 54, 59, 54, 72, 32, 32, 32, 27, 91, 51, 55, 59, 54, 72, 27, 91, 51, 52, 59, 49, 48, 72, 49, 50, 51, 27, 91, 51, 53, 59, 49, 48, 72, 52, 53, 54, 27, 91, 51, 54, 59, 49, 48, 72, 55, 56, 57, 27, 91, 51, 55, 59, 49, 48, 72, 27, 91, 51, 52, 59, 49, 52, 72, 32, 32, 32, 27, 91, 51, 53, 59, 49, 52, 72, 32, 56, 32, 27, 91, 51, 54, 59, 49, 52, 72, 32, 32, 32, 27, 91, 51, 55, 59, 49, 52, 72, 27, 91, 51, 52, 59, 49, 56, 72, 49, 50, 51, 27, 91, 51, 53, 59, 49, 56, 72, 52, 53, 54, 27, 91, 51, 54, 59, 49, 56, 72, 55, 56, 57, 27, 91, 51, 55, 59, 49, 56, 72, 27, 91, 51, 52, 59, 50, 50, 72, 32, 32, 32, 27, 91, 51, 53, 59, 50, 50, 72, 32, 49, 32, 27, 91, 51, 54, 59, 50, 50, 72, 32, 32, 32, 27, 91, 51, 55, 59, 50, 50, 72, 27, 91, 51, 52, 59, 50, 54, 72, 32, 32, 32, 27, 91, 51, 53, 59, 50, 54, 72, 32, 51, 32, 27, 91, 51, 54, 59, 50, 54, 72, 32, 32, 32, 27, 91, 51, 55, 59, 50, 54, 72, 27, 91, 51, 52, 59, 51, 48, 72, 32, 32, 32, 27, 91, 51, 53, 59, 51, 48, 72, 32, 52, 32, 27, 91, 51, 54, 59, 51, 48, 72, 32, 32, 32, 27, 91, 51, 55, 59, 51, 48, 72, 27, 91, 51, 52, 59, 51, 52, 72, 49, 50, 51, 27, 91, 51, 53, 59, 51, 52, 72, 52, 53, 54, 27, 91, 51, 54, 59, 51, 52, 72, 55, 56, 57, 27, 91, 51, 55, 59, 51, 52, 72];